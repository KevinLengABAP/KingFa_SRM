sap.ui.define(["ZEC_MY_REQUIREMENTS/controller/BaseController","sap/ui/model/json/JSONModel","sap/m/GroupHeaderListItem","sap/ui/core/Priority","sap/m/MessageToast","sap/ui/model/Filter","sap/ui/core/routing/History","sap/ui/model/odata/ODataModel","sap/ui/core/Core","sap/ui/core/mvc/Controller","ZEC_MY_REQUIREMENTS/utils/Validator","ZEC_MY_REQUIREMENTS/utils/ValueHelpHelper"],function(e,t,i,s,l,a,r,o,n,g,d,h){"use strict";var u=new t;return e.extend("ZEC_MY_REQUIREMENTS.controller.RequireDetailEditPo",{onInit:function(){this.getOwnerComponent().getRouter().getRoute("requireEditPo").attachPatternMatched(this._onRequestEditMatched,this);this.getView().setModel(u,"RequireDetailEdit")},_onRequestEditMatched:function(e){var t=new Date;var i={};if(sap.ui.getCore().edititem){$.extend(i,sap.ui.getCore().edititem);if(i.Ekgrp){this.getView().byId("EKGRP").setEditable(false)}if(!i.Knttp){i.Knttp="I"}if(!i.DelivDate){i.DelivDate=t}u.setData(i);this.setFieldAttr(i.Knttp);if(this.getGlobalVar("Bsart")==="KF30"){this.setFieldAttr("A");this.getView().byId("Knttp").setSelectedKey("A");this.getView().byId("Knttp").setEditable(false)}else{this.getView().byId("Knttp").setEditable(true)}}else{this.getOwnerComponent().getRouter().navTo("main")}},handleChangeKnttp:function(e){var t=e.getParameter("selectedItem").getProperty("key");this.setFieldAttr(t)},handleLgortValueHelp:function(e){var t=e.getSource();var i=this.getView().getModel();var s=this.getView().byId("WERKS").getSelectedKey();var l="ZshLgortSet";var r=[];r=[new a("Werks",sap.ui.model.FilterOperator.EQ,s)];this.valuehelp=new h(i);this.valuehelp.excludeFilters(["Werks"]);this.valuehelp.excludeColumns(["Werks"]);this.valuehelp.initFilters(r);this.valuehelp.openValueHelp(l,"Lgort","LgortTxt",function(e,i,s){t.setValue(e)})},setFieldAttr:function(e){switch(e){case"A":this.getView().byId("Label_Hkont").setVisible(false);this.getView().byId("Hkont").setVisible(false);this.getView().byId("Hkont").setValue("");this.getView().byId("Label_Kostl").setVisible(false);this.getView().byId("Kostl").setVisible(false);this.getView().byId("Kostl").setValue("");this.getView().byId("Label_Lgort").setVisible(false);this.getView().byId("Lgort").setVisible(false);this.getView().byId("Lgort").setValue("");break;case"I":this.getView().byId("Label_Hkont").setVisible(false);this.getView().byId("Hkont").setVisible(false);this.getView().byId("Hkont").setValue("");this.getView().byId("Label_Kostl").setVisible(false);this.getView().byId("Kostl").setVisible(false);this.getView().byId("Kostl").setValue("");this.getView().byId("Label_Lgort").setVisible(true);this.getView().byId("Lgort").setVisible(true);break;case"K":this.getView().byId("Label_Hkont").setVisible(true);this.getView().byId("Hkont").setVisible(true);this.getView().byId("Label_Kostl").setVisible(true);this.getView().byId("Kostl").setVisible(true);this.getView().byId("Label_Lgort").setVisible(false);this.getView().byId("Lgort").setVisible(false);this.getView().byId("Lgort").setValue("");break}},onWerksChange:function(e){var t=this.getView().byId("Lgort");this.getModel("RequireDetailEdit").setProperty("Lgort",null);t.setValue("")},onApply:function(e){var t=new d;var i=this.byId("CheckLayout");if(t.validate(i)){var s=this.getView().getModel("RequireDetailEdit").getData();s.Knttp=this.getView().byId("Knttp").getSelectedKey();var a=s.Menge;if(a<=0){l.show("行"+s.Posnr+"数量大于等于1");return}if(a.toString().length>10){l.show("行号"+s.Posnr+"数量长度不得超过10位");return}var r=this.getOwnerComponent().getEventBus();r.publish("applyChange",s);this.onNavBack()}},onRequireDetailNavBack:function(){var e=this.getView().getModel("RequireDetailEdit").getData();this.confirmNavBack(e,sap.ui.getCore().edititem)}})});
//# sourceMappingURL=RequireDetailEditPo.controller.js.map
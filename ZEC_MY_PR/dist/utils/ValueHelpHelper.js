sap.ui.define(["sap/ui/base/Object","sap/ui/comp/valuehelpdialog/ValueHelpDialog","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/model/odata/ODataModel","sap/ui/model/json/JSONModel","sap/ui/comp/filterbar/FilterBar","sap/ui/comp/filterbar/FilterGroupItem","sap/m/Input","sap/m/SearchField"],function(e,t,i,n,a,r,l,s,o,u){"use strict";return e.extend("ZEC_MY_REQUIREMENTS.utils.ValueHelpHelper",{onInit:function(){},constructor:function(e){this.model=e},initFilters:function(e){this._aInitFilters=e},excludeFilters:function(e){this._aFilterFields=e},excludeColumns:function(e){this._aColumnsFields=e},setModel:function(e,t){var i=this.model.getServiceMetadata().dataServices.schema[0];var n=i.entityContainer[0].entitySet.find(function(t){return t.name===e});var a=n.entityType.lastIndexOf(".")+1;var r=i.entityType.find(function(e){return e.name===n.entityType.substring(a)});this.oColModel={cols:[]};this.aFilterGroup=[];var l;for(l=0;l<r.property.length;l++){if(this._aColumnsFields){if(this._aColumnsFields.indexOf(r.property[l].name)>=0){continue}}var u=r.property[l].extensions.find(function(e){return e.name==="label"});var p={label:u.value,template:r.property[l].name};if(r.property[l].type==="Edm.DateTime"){p.type="date";p.oType=new sap.ui.model.odata.type.Date}this.oColModel.cols.push(p);if(t===r.property[l].name){this.sTitle=u.value}if(this._aFilterFields){if(this._aFilterFields.indexOf(r.property[l].name)>=0){continue}}this.aFilterGroup.push(new s({groupTitle:"More Fields",groupName:"gn1",name:r.property[l].name,label:u.value,control:new o(r.property[l].name),visibleInFilterBar:true}))}},openValueHelp:function(e,a,s,o){var u=this;this.binding="/"+e;this.col={};this.setModel(e,a);var p=new t({title:this.sTitle||"Search",supportMultiselect:false,supportRanges:false,supportRangesOnly:false,key:a,descriptionKey:s||"",ok:function(e){var t=e.getParameter("tokens")[0];var i=t.getProperty("key");var n=t.getProperty("text");var a=t.data("row");p.close();o.call(this,i,n,a)},cancel:function(e){p.close()},afterClose:function(){p.destroy()}});p.getTableAsync().then(function(e){e.setModel(new r(u.oColModel),"columns");e.setModel(u.model);var t=[];if(u._aInitFilters){t=u._aInitFilters}if(e.bindRows){e.bindRows({path:u.binding,filters:t})}if(e.bindItems){e.bindAggregation("items",u.binding,function(t,i){var n=e.getModel("columns").getData().cols;return new sap.m.ColumnListItem({cells:n.map(function(e){var t=e.template;return new sap.m.Label({text:"{"+t+"}"})})})},"",t)}});var d=new l({advancedMode:true,filterBarExpanded:true,filterGroupItems:this.aFilterGroup,search:function(e){var t=[];if(u._aInitFilters){for(var a in u._aInitFilters){t[a]=u._aInitFilters[a]}}$.each(arguments[0].getParameter("selectionSet"),function(e,a){if(a.getValue()){t.push(new i(a.getId(),n.Contains,a.getValue()))}});if(p.getTable()instanceof sap.m.Table){p.getTable().bindAggregation("items",u.binding,function(e,t){var i=p.getTable().getModel("columns").getData().cols;return new sap.m.ColumnListItem({cells:i.map(function(e){var t=e.template;return new sap.m.Label({text:"{"+t+"}"})})})},"",t)}else{p.getTable().bindRows({path:u.binding,filters:t,and:true})}},clear:function(e){sap.m.MessageToast.show("Clear pressed")}});p.setFilterBar(d);p.open()}})});
//# sourceMappingURL=ValueHelpHelper.js.map